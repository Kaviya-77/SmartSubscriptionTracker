<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>My Subscriptions</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        body {
            background: #f4f7fa;
        }
        .container {
            margin-top: 50px;
        }
        .btn-add {
            background: #28a745;
            color: white;
        }
        .btn-add:hover { background: #218838; }

        .btn-edit {
            background: #ffc107;
            color: black;
        }
        .btn-edit:hover { background: #e0a800; }

        .btn-delete {
            background: #dc3545;
            color: white;
        }
        .btn-delete:hover { background: #c82333; }

        .btn-expiry {
            background: #0d6efd;
            color: white;
        }
        .btn-expiry:hover { background: #0b5ed7; }
    </style>
</head>
<body>

<div class="container">
    <div class="d-flex justify-content-between mb-3">
        <h2>My Subscriptions</h2>
        <a href="/subscriptions/add" class="btn btn-add">+ Add Subscription</a>
    </div>

    <div class="card p-3">
        <table class="table table-hover align-middle">
            <thead class="table-dark">
                <tr>
                    <th>ID</th>
                    <th>Service Name</th>
                    <th>Amount</th>
                    <th>Expiry Date</th>
                    <th width="280">Actions</th>
                </tr>
            </thead>

            <tbody>
                <tr th:each="sub : ${subscriptions}">
                    <td th:text="${sub.id}"></td>
                    <td th:text="${sub.name}"></td>
                    <td th:text="${sub.amount}"></td>
                    <td th:text="${sub.expiryDate}"></td>

                    <td>
                        <!-- EDIT BUTTON -->
                        <a th:href="@{/subscriptions/edit/{id}(id=${sub.id})}"
                           class="btn btn-edit btn-sm">Edit</a>

                        <!-- DELETE BUTTON -->
                        <a th:href="@{/subscriptions/delete/{id}(id=${sub.id})}"
                           onclick="return confirm('Delete this subscription?')"
                           class="btn btn-delete btn-sm">Delete</a>

                        <!-- UPDATE EXPIRY FORM -->
                        <form th:action="@{/subscriptions/expiry/{id}(id=${sub.id})}"
                              method="post" class="d-flex mt-1">

                            <input type="date" name="expiryDate"
                                   class="form-control form-control-sm me-2"
                                   required>

                            <button type="submit" class="btn btn-expiry btn-sm">
                                Update Expiry
                            </button>
                        </form>

                    </td>
                </tr>
            </tbody>

        </table>
    </div>
</div>

</body>
</html>
